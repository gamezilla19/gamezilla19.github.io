---
title: Username enumeration via different responses
author: Gamezilla
date: 2025-06-05 14:00:00 +0100
categories: [PortSwigger]
comments: false
toc: false
pin: false
tags: [portswigger, burp, burpsuite, SSV, courses, Bruteforce]
math: false
mermaid: false
---

## 1. Statement

This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:

- Candidate usernames
- Candidate passwords

To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.



![enonce](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/enonce.png)


---

## 2. Challenge

### a. User ID controlled by request parameter with password disclosure, what is it ?

Conceptually, authentication vulnerabilities are easy to understand. However, they are usually critical because of the clear relationship between authentication and security.

Authentication vulnerabilities can allow attackers to gain access to sensitive data and functionality. They also expose additional attack surface for further exploits. For this reason, it's important to learn how to identify and exploit authentication vulnerabilities, and how to bypass common protection measures.

In this section, we explain:

The most common authentication mechanisms used by websites.
Potential vulnerabilities in these mechanisms.
Inherent vulnerabilities in different authentication mechanisms.
Typical vulnerabilities that are introduced by their improper implementation.
How you can make your own authentication mechanisms as robust as possible.

What is the difference between authentication and authorization?
Authentication is the process of verifying that a user is who they claim to be. Authorization involves verifying whether a user is allowed to do something.

For example, authentication determines whether someone attempting to access a website with the username Carlos123 really is the same person who created the account.

Once Carlos123 is authenticated, their permissions determine what they are authorized to do. For example, they may be authorized to access personal information about other users, or perform actions such as deleting another user's account.

Brute-force attacks
A brute-force attack is when an attacker uses a system of trial and error to guess valid user credentials. These attacks are typically automated using wordlists of usernames and passwords. Automating this process, especially using dedicated tools, potentially enables an attacker to make vast numbers of login attempts at high speed.

Brute-forcing is not always just a case of making completely random guesses at usernames and passwords. By also using basic logic or publicly available knowledge, attackers can fine-tune brute-force attacks to make much more educated guesses. This considerably increases the efficiency of such attacks. Websites that rely on password-based login as their sole method of authenticating users can be highly vulnerable if they do not implement sufficient brute-force protection.

Brute-forcing usernames
Usernames are especially easy to guess if they conform to a recognizable pattern, such as an email address. For example, it is very common to see business logins in the format firstname.lastname@somecompany.com. However, even if there is no obvious pattern, sometimes even high-privileged accounts are created using predictable usernames, such as admin or administrator.

During auditing, check whether the website discloses potential usernames publicly. For example, are you able to access user profiles without logging in? Even if the actual content of the profiles is hidden, the name used in the profile is sometimes the same as the login username. You should also check HTTP responses to see if any email addresses are disclosed. Occasionally, responses contain email addresses of high-privileged users, such as administrators or IT support.

Brute-forcing passwords
Passwords can similarly be brute-forced, with the difficulty varying based on the strength of the password. Many websites adopt some form of password policy, which forces users to create high-entropy passwords that are, theoretically at least, harder to crack using brute-force alone. This typically involves enforcing passwords with:

A minimum number of characters
A mixture of lower and uppercase letters
At least one special character

However, while high-entropy passwords are difficult for computers alone to crack, we can use a basic knowledge of human behavior to exploit the vulnerabilities that users unwittingly introduce to this system. Rather than creating a strong password with a random combination of characters, users often take a password that they can remember and try to crowbar it into fitting the password policy. For example, if mypassword is not allowed, users may try something like Mypassword1! or Myp4$$w0rd instead.

In cases where the policy requires users to change their passwords on a regular basis, it is also common for users to just make minor, predictable changes to their preferred password. For example, Mypassword1! becomes Mypassword1? or Mypassword2!.

This knowledge of likely credentials and predictable patterns means that brute-force attacks can often be much more sophisticated, and therefore effective, than simply iterating through every possible combination of characters.

Username enumeration
Username enumeration is when an attacker is able to observe changes in the website's behavior in order to identify whether a given username is valid.

Username enumeration typically occurs either on the login page, for example, when you enter a valid username but an incorrect password, or on registration forms when you enter a username that is already taken. This greatly reduces the time and effort required to brute-force a login because the attacker is able to quickly generate a shortlist of valid usernames.

### b. Vulnerability Analysis

As the course explains it to us, as we arrive on the Lab, we will directly use Burp, 
When we are on Burp, we will intercept a login request as described on the picture :


![burpintercept](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/burpintercept.png)

Burp will return this :
```
POST /login HTTP/2
Host: 0a690011034e43cd802ba87b00060000.web-security-academy.net
Cookie: session=fhMeTulM5g8KFmSTJIz5LqkA0lGbqw3e
Content-Length: 31
Cache-Control: max-age=0
Sec-Ch-Ua: "Not.A/Brand";v="99", "Chromium";v="136"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Accept-Language: fr-FR,fr;q=0.9
Origin: https://0a690011034e43cd802ba87b00060000.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a690011034e43cd802ba87b00060000.web-security-academy.net/login
Accept-Encoding: gzip, deflate, br
Priority: u=0, i

username=test&password=password
```
We see that in the last line, is written the request we sent. we will then select the username parameter i.e test and select "Send to Intruder"

![intruder1](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/intruder1.png)

```
username=$test$&password=password
```
which means that the intruder will now change the "test" parameter with a list we will give him on the panel we have on the right of our screen 

![intruderconf](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/intruderconf.png)

As you see, on the right we have the "Payload Configuration" where we'll be able to paste the list that PortSwigger gave us to try :

![payload](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/payloadconf.png)

We will make sure to be in "Sniper attack" mode before trying the bruteforce, then we press on " Start attack".
After a few seconds, the 101 usernames were tested. We will proceed to the analysis of the length of the answer made by the server.

![username](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/username.png)

we find that the "puppet" username has responded something bigger than others, as we try it directly on the website, we find that the answer is not "invalid username" but "invalid password" which confirm that we found a username for the website.

![incpassword](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/incpassword.png)

We will doubleclick on the puppet username, and then do the same trick for the password, select password with the username puppet, send it to intruder, bruteforce, then find the answer.

![intruder2](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/intruder2.png)

Then, again we analyze the length, we find that "sunshine" password seems to be the correct one, we will try that.
We find out that it works which ends the Lab and the writeup.

![final](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/Authentication/final.png)

---

## END of the writeup.

