---
title: User Role Controlled by Request Parameter with Unpredictable user IDs
author: Gamezilla
date: 2025-05-30 14:00:00 +0100
categories: [PortSwigger]
comments: false
toc: false
pin: false
tags: [portswigger, burp, burpsuite, SSV, courses, URCRPUUID]
math: false
mermaid: false
---

## 1. Statement

This lab has a horizontal privilege escalation vulnerability on the user account page, but identifies users with GUIDs.

To solve the lab, find the GUID for carlos, then submit his API key as the solution.

You can log in to your own account using the following credentials: wiener:peter


![enonce](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/URCRPUUID/enonce.png)


---

## 2. Challenge

### a. User role controlled by request parameter, what is it ?

Horizontal privilege escalation
Horizontal privilege escalation occurs if a user is able to gain access to resources belonging to another user, instead of their own resources of that type. For example, if an employee can access the records of other employees as well as their own, then this is horizontal privilege escalation.

Horizontal privilege escalation attacks may use similar types of exploit methods to vertical privilege escalation. For example, a user might access their own account page using the following URL:

https://insecure-website.com/myaccount?id=123
If an attacker modifies the id parameter value to that of another user, they might gain access to another user's account page, and the associated data and functions.

```
Note
This is an example of an insecure direct object reference (IDOR) vulnerability. This type of vulnerability arises where user-controller parameter values are used to access resources or functions directly.
```

In some applications, the exploitable parameter does not have a predictable value. For example, instead of an incrementing number, an application might use globally unique identifiers (GUIDs) to identify users. This may prevent an attacker from guessing or predicting another user's identifier. However, the GUIDs belonging to other users might be disclosed elsewhere in the application where users are referenced, such as user messages or reviews.

### b. Vulnerability Analysis

As the course explains it to us, as we arrive on the website, we find that the site is a blog this time, so, we can find many articles like this one :

![accueil](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/URCRPUUID/accueil.png)

as we go on the article, we can see the author of it, we're interested in Carlos, so we find an article that he wrote :

![carlos](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/URCRPUUID/carlos.png)

we find that the name carlos is clickable, when we click on the username we find that this url at the top of our browser :

```
https://lab-website.com/blogs?userId=838c641f-8905-45d8-a31a-acf941b90db0
```
we find that Carlos ID is : 838c641f-8905-45d8-a31a-acf941b90db0

We are then going to connect ourselves with wiener:peter

we find that the new url is this one : 
```
https://lab-website.com/my-account?id=b8ef5c5e-b640-4821-9212-f029e30c18b2
```
We will then proceed to change the my-account?id to his ID :

```
https://lab-website.com/my-account?id=838c641f-8905-45d8-a31a-acf941b90db0
```
---
We then find out that we are now connected as Carlos : 

![carlosID](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/URCRPUUID/carlosID.png)


As we find Carlos' API, we can now add the API Key in the "Submit Solution" part and that ends the challenge, and hereby the writeup

![ending](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/URCRPUUID/ending.png)


---

## END of the writeup.

