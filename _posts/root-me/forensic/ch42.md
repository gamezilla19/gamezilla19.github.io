---
title: ROOTME – Forensic - Capture Moi Ça
author: Gamezilla
date: 2025-05-26 14:00:00 +0100
categories: [Forensic]
comments: true
toc: true
pin: false
tags: [rootme, forensic, acropalypse, cve-2023-21036]
math: false
mermaid: false
---

[Challenge on RootMe](https://www.root-me.org/fr/Challenges/Forensic/Capture-moi-ca)

---

## 1. Statement

An employee has lost his KeePass password. He can't remember it and can't find his password file. After hours of searching, he found he sent a screenshot of his passwords to a colleague, but they remain untraceable.

He asks for your help in trying to recover it.  
It's your turn.

**Files provided:**
- A `.kbdx` file (KeePass database)
- A `.png` file (screenshot)

![Screenshot preview](/assets/img/posts/forensic/capture-moi-ca/capture_apercu.png)
_Screenshot preview_

---

## 2. Introduction

On this screenshot and with the statement, we can see that many passwords and websites with logins are written, which leads us to believe that the man (or, in this case, the coworker) keeps his friend's passwords in an Excel file (strange, isn’t it?).

At first, we only see 4 passwords, but then, when we look at the right of the picture on the Excel, we may be able to see a “K” for KeePass probably.

---

## 3. Challenge

### a. Screenshot analysis

The Introduction explains what we can see first. But by taking an even closer look we see that the image is cropped, so we’re now interested in “decropping” that image.

What is interesting to see after that is the hexadecimal we can extract from this .png.  
For that:

![hexdump](/assets/img/posts/forensic/capture-moi-ca/hexdump.png)
_hexdump_

Hexdump is our friend, it can be used to see the hexadecimal of a picture.  
We are then interested in checking the headers and tailers of the PNG file, i.e.  

![headers](/assets/img/posts/forensic/capture-moi-ca/headers.png)
_headers_

A PNG picture always begins with `89 50 4e 47 0d 0a 1a 0a`  
And the IHDR is written `00 00 00 0d 49 48 44 52`.

These elements are always defined as the headers of any .png file.  
At the end of it, we’re supposed to find one and only one IEND written like that:  

![singleIEND](/assets/img/posts/forensic/capture-moi-ca/singleiend.png)
_singleIEND_

That is a normal composition of a PNG file.  
However, in this case, we find two of them:

![Hexdump showing double IEND](/assets/img/posts/forensic/capture-moi-ca/png_double_iend.png)
_Hexdump showing double IEND_

As you may have understood, we will then proceed to the vulnerability analysis:

---

### b. Vulnerability Analysis

As we search the web for “screenshots double IEND png vulnerabilities”, we find something called “Acropalypse”.

CVE: CVE-2023-21036

“aCropalypse (CVE-2023-21036) was a vulnerability in Markup, a screenshot editing tool introduced in Google Pixel phones with the release of Android Pie. The vulnerability, discovered in 2023 by security researchers Simon Aarons and David Buchanan, allows an attacker to view an uncropped and unaltered version of a screenshot. Following aCropalypse's discovery, a similar zero-day vulnerability was also discovered, affecting Snip & Sketch for Windows 10 and Snipping Tool for Windows 11.”

This is the Wikipedia definition of this exploit.

As we continued searching, we found the github page of a dev that did it for us.  
A script called... Acropalypse, how bizarre.  
We clone it then launch it.

![Using the Acropalypse script](/assets/img/posts/forensic/capture-moi-ca/acropalypse_script.png)
_Using the Acropalypse script_

We get this page : 

![ecranpr](/assets/img/posts/forensic/capture-moi-ca/ecranpr.png)
_ecranpr_

Then proceed to the "Restoring Tool" section: 

![ecransec](/assets/img/posts/forensic/capture-moi-ca/ecransec.png)
_ecransec_

As we believe the screenshot was made on a display of 1920x1080, we put in these settings, with custom RGBA, and we launch Acropalypse : 

![ecranfinal](/assets/img/posts/forensic/capture-moi-ca/ecranfinal.png)
_ecranfinal_

After a few seconds, that’s what we get:

![resultat](/assets/img/posts/forensic/capture-moi-ca/resultat.png)
_resultat_

---

#### Password recovery

Now that we have the KeePass password, we insert it in the KeePass file:

-=b9w9h^+j%\x-rMPUqv9Vv`@X%*=a


We then copy the password on our keyboard and find the flag:

@cropalypse_vuln_is_impressive


---

## END of the writeup.

